{
  "hash": "f3fcb2103b86ab17f2cfbe17e3e4bf0f",
  "result": {
    "markdown": "---\ntitle: \"Analyzing Which Ocean Activities Are Most Likely to Encounter Aggressive Shark Behavior \"\ndescription: \"This is an analysis that conducted, where I looked at data containing accounts of aggressive shark behavior across the globe going all the way back to 1638 through 2023. I wanted to find out which activities people were doing when a shark became aggressive towards them.\"\nauthor:\n  - name: Fletcher McConnell\n    url: https://fletcher-m.github.io/\n   # orcid:\n    affiliation: MEDS\n    affiliation-url: https://bren.ucsb.edu/masters-programs/master-environmental-data-science/academics-meds\n # - name: other person\ndate: 03-09-2024\ncategories: [Ocean, MEDS, Sharks, Visualization]\nbibliography: references.bib\ncitation:\n  url: https://fletcher-m.github.io/blog/2024-03-09-shark-aggression-analysis/\nimage: shark_image.png\neval: FALSE\n---\n\n\n# Motivation Behind this Analysis\n\nI have been around the ocean for the majority of my life and have enjoyed having fun riding waves or exploring beneath them. I have swam with sharks many times and it has always been a positive experience for me. Ever since the first Jaws movie came out, sharks have been perceived as a killing machine, with a blood lust that can only be appeased by taking human lives. In reality, this is so far from the truth. Sharks are incredible animals and on the rare occasions where they do have a negative interaction with humans, it is often a mistake on the shark's part. I wanted to display the data to pull away the curtain of uncertainty on where sharks act aggressively. I hope that this post is informative and not scary. \n\nData Available Here: https://public.opendatasoft.com/explore/dataset/global-shark-attack/table/?flg=en-us&disjunctive.country&disjunctive.area&disjunctive.activity\n\n* This data had many missing values in some of the columns that I used for my analysis. There were also inconsistent naming conventions within columns. I did my best to work with these abnormalities, but there is absolutely room for error in my results. \n\n# The Analysis Process\n\nThe \"activity\" column had hundreds of different descriptions detailing what someone was doing when they were aggressed on by a shark. I chose to analyze 5 common activities: surfing, swimming, diving, fishing and wading. It is important to note that, due to the inconsistency in naming, each of these categories contain variations of subgroups within them. For example, fishing includes any string with \"fishing\" in it. This could be \"spearfishing\", or \"boat fishing\" for example. \n\n# Creating Visualizations\n\nBelow are the libraries that I used:\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# load packages ----\nlibrary(tidyverse)\nlibrary(here)\nlibrary(readr)\nlibrary(janitor)\nlibrary(corrplot)\nlibrary(fmsb)\nlibrary(dplyr)\nlibrary(showtext)\nlibrary(png)\nlibrary(grid)\nlibrary(ggrepel)\nlibrary(ggtext)\nlibrary(glue)\n```\n:::\n\n\nI created three types of visualizations for this analysis. Each visualization is tied with one another, through looking at different aspects of the 5 activities mentioned above.\n\n# Spider Plot \n\nFor the spider plot, I wanted to visualize the 3 most commonly known aggressive species (Tiger Shark, White Shark, Bull Shark) if there is any difference in the types of activities that they are most aggressive towards. I first calculated proportions of attacks for each activity, for each species.  \n\n## Tiger Shark\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nsum(grepl(\"tiger shark\", sharks$species, ignore.case = TRUE) & grepl(\"fishing\", sharks$activity, ignore.case = TRUE))\n\nsum(grepl(\"tiger shark\", sharks$species, ignore.case = TRUE) & grepl(\"surfing|paddle boarding|body boarding\", sharks$activity, ignore.case = TRUE))\n\nsum(grepl(\"tiger shark\", sharks$species, ignore.case = TRUE) & grepl(\"diving\", sharks$activity, ignore.case = TRUE))\n\nsum(grepl(\"tiger shark\", sharks$species, ignore.case = TRUE) & grepl(\"standing|wading|floating\", sharks$activity, ignore.case = TRUE))\n\nsum(grepl(\"tiger shark\", sharks$species, ignore.case = TRUE) & grepl(\"swimming\", sharks$activity, ignore.case = TRUE))\n```\n:::\n\n\n## White Shark\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nsum(grepl(\"white shark\", sharks_spider$species, ignore.case = TRUE) & grepl(\"fishing\", sharks_spider$activity, ignore.case = TRUE))\n\nsum(grepl(\"white shark\", sharks_spider$species, ignore.case = TRUE) & grepl(\"surfing|paddle boarding|body boarding\", sharks_spider$activity, ignore.case = TRUE))\n\nsum(grepl(\"white shark\", sharks_spider$species, ignore.case = TRUE) & grepl(\"diving\", sharks_spider$activity, ignore.case = TRUE))\n\nsum(grepl(\"white shark\", sharks_spider$species, ignore.case = TRUE) & grepl(\"standing|wading|floating\", sharks_spider$activity, ignore.case = TRUE))\n\nsum(grepl(\"white shark\", sharks_spider$species, ignore.case = TRUE) & grepl(\"swimming\", sharks_spider$activity, ignore.case = TRUE))\n```\n:::\n\n\n## Bull Shark\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nsum(grepl(\"bull shark\", sharks_spider$species, ignore.case = TRUE) & grepl(\"fishing\", sharks_spider$activity, ignore.case = TRUE))\n\nsum(grepl(\"bull shark\", sharks_spider$species, ignore.case = TRUE) & grepl(\"surfing|paddle boarding|body boarding\", sharks_spider$activity, ignore.case = TRUE))\n\nsum(grepl(\"bull shark\", sharks_spider$species, ignore.case = TRUE) & grepl(\"diving\", sharks_spider$activity, ignore.case = TRUE))\n\nsum(grepl(\"bull shark\", sharks_spider$species, ignore.case = TRUE) & grepl(\"standing|wading|floating\", sharks_spider$activity, ignore.case = TRUE))\n\nsum(grepl(\"bull shark\", sharks_spider$species, ignore.case = TRUE) & grepl(\"swimming\", sharks_spider$activity, ignore.case = TRUE))\n```\n:::\n\n\nI then used the values calculated for each of the three species of sharks to construct a spider plot in order to visualize differences among species. \n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# create data frame for spider plot to draw from (each value scaled up by 2.7)\nsharks_table <- data.frame(\n  species = c(\"max\", \"min\", \"white shark\", \"tiger shark\", \"bull shark\"),\n  fishing = c(100, 0, 77.22, 62.1, 84.24),\n  surfing = c(100, 0, 99.9, 88.83, 63.99),\n  diving = c(100, 0, 50.76, 47.25, 23.49),\n  \"wading\" = c(100, 0, 4.32, 14.04, 20.25),\n  swimming = c(100, 0, 38.07, 57.78, 78.03)\n)\n\n# change species column to index \nrownames(sharks_table) <- sharks_table$species\n\nsharks_table <- sharks_table[,-1]\n\n# adjust the margins of the plot\npar(mar = c(5, 2, 8, 2) + 0.1)\n\n# create spider plot\nradarchart(sharks_table, \n           cglty = 0, # specify grid line type\n           cglcol = \"gray\",\n           pcol = c(1,2,4),\n           plwd = 2,\n           plty = c(1, 2, 3),\n           vlcex = 1.25\n           )\n\n# add title to plot\ntitle(main = \"Proportion of Attacks By Activity for 3 Shark Species\", \n      cex.main = 2,\n      family = \"josefin\")\n\n# add legend\nlegend(\"topright\",\n       legend = c(\"White Shark\", \"Tiger Shark\", \"Bull Shark\"),\n       lty = c(1,2,3),\n       col = c(1, 2, 4),\n       lwd = 2,\n       title = \"Species\")\n\n# add caption beneath plot\ngrid.text(\"* Total number of attacks across all 5 activities are as follows: White Shark - 576, Tiger Shark - 252, Bull Shark - 173 *\",\n          x = 0.5, y = 0.05, \n          just = c(\"center\", \"bottom\"),\n          gp = gpar(fontsize = 10, col = \"gray\"))\n```\n:::\n\n\n![](spider_plot_final.png)\nThis visualization gives some interesting insight into how these three species differ in which activities they are involved in. You can see that White Sharks are mostly involved in surfing incidents and Bull Sharks are mostly involved in swimming incidents. \n\n# Stacked Bar Plot\n\nI next thought that it would be useful to know what the number of fatal vs. non-fatal attacks looks like for each of the 5 activities. I decided to use a stacked bar plot to show this. A note is that I added the pictures next to each bar outside of R. The code produced labels (surfing, fishing, swimming, diving, wading) next to each bar. \n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Define the activities\nactivities <- c(\"fishing\", \"surfing\", \"diving\", \"wading\", \"swimming\")\n\n# Function to count occurrences of activities by sex\ncount_activities_by_fatality <- function(activity) {\n  sapply(c(\"N\", \"Y\"), function(fatal_y_n) sum(grepl(activity, sharks$activity[sharks$fatal_y_n == fatal_y_n], ignore.case = TRUE)))\n}\n\n# Count occurrences of activities for males (\"M\") and females (\"F\")\nactivity_counts <- sapply(activities, count_activities_by_fatality)\n\n# Create a data frame with counts of fatal / non-fatal for each activity\nactivity_data <- data.frame(\n  activity = rep(activities, each = 2),\n  fatal_y_n = rep(c(\"Non-Fatal\", \"Fatal\"), times = length(activities)),\n  count = as.vector(activity_counts)\n)\n\n# Define the order of activities\nactivity_order <- c(\"wading\", \"diving\", \"swimming\", \"fishing\", \"surfing\")\n\n\ntitle <- glue::glue(\"Count of <span style='color:#00ced1;font-size:20pt;'>**Non-Fatal**</span> and <span style='color:#9c1515;font-size:20pt;'>**Fatal**</span> Shark Attacks by Activity\")\n\n# Create the stacked bar chart\nggplot(activity_data, aes(x = factor(activity, levels = activity_order), y = count, fill = fatal_y_n)) +\n  geom_bar(stat = \"identity\", position = \"stack\") +\n  geom_text(aes(label = count), \n            position = position_stack(vjust = 0.5), \n            size = 3, \n            color = \"black\", \n            fontface = \"bold\") +\n  labs(title = NULL,  # Remove the title here\n       x = NULL,\n       y = \"Total Number of Incidents\",\n       caption = \"* Data comes from global shark aggression cases dating back to 1638\") +\n  scale_fill_manual(values = c(\"Fatal\" = \"#9c1515\", \"Non-Fatal\" = \"#00ced1\")) +\n  theme_minimal() +\n  coord_flip() +\n  guides(fill = guide_legend(title = NULL)) +\n  theme(\n    plot.title = element_markdown(family = \"josefin\",\n                                  face = \"bold\",\n                                  size = 21,\n                                  hjust = 0.5,\n                                  margin = margin(b = 20)),\n    axis.text.x = element_blank(),\n   # axis.text.y = element_blank(),\n    plot.margin = margin(40, 70, 20, 70),\n    axis.title.x = element_blank(), \n    axis.title.y = element_text(margin = margin(r = 20), hjust = 0.5),\n    plot.caption = element_text(size = 10, color = \"gray\", hjust = 0.5, margin = margin(t = 10)),\n    panel.grid.major = element_blank(),  \n    panel.grid.minor = element_blank(),\n    legend.position = \"none\"\n  ) +\n  ggtitle(glue::glue(\"{title}\"))\n```\n:::\n\n\n![](bar_plot_final.png)\nThe main idea that I pulled away from this plot is that the majority of incidents are non-fatal, although swimming has an abnormally high proportion of fatal incidents. This may be due to the fact that, when you are swimming, you do not have a surfboard or other object to block an attack. This is only one guess, however.\n\n# Line Plot \n\nIn order to introduce the time variable into a plot, I decided to use a line plot to display the yearly count of number of attacks from 1900 to 2025. I first thought that I would display all 5 activities next to each other in order to compare trends, but ultimately decided to focus on surfing. Surfing had the largest increase and I believe that it can be attributed to the growing popularity of the sport around the world. \n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nsharks_line <- sharks |> \n  select(year, activity) |> \n  filter(grepl(\"swimming|surfing|diving|fishing|standing|wading|floating\", activity, ignore.case = TRUE)) |> \n  filter(year > 1900 & year < 2023) |> \n  mutate(activity_group = case_when(\n    grepl(\"fishing\", activity, ignore.case = TRUE) ~ \"Fishing\",\n    grepl(\"surfing\", activity, ignore.case = TRUE) ~ \"Surfing\",\n    grepl(\"diving\", activity, ignore.case = TRUE) ~ \"Diving\",\n    grepl(\"wading|standing|floating\", activity, ignore.case = TRUE) ~ \"Wading\",\n    grepl(\"swimming\", activity, ignore.case = TRUE) ~ \"Swimming\"\n  ))\n\nactivity_counts <- sharks_line %>%\n  group_by(year, activity_group) %>%\n  summarize(count = n()) %>%\n  ungroup()\n\np <- ggplot(activity_counts, aes(x = year, y = count, color = activity_group)) +\n  geom_line() +\n  labs(\n    title = \"Number of Surfing-Related Shark Incidents Over the Years\",\n    x = \"Year\",\n    y = \"Total Count\",\n    color = \"Activity Group\"\n  ) +\n  scale_color_viridis_d() +\n  scale_x_continuous(limits = c(1900, 2023)) +\n  theme_minimal() +\n  gghighlight::gghighlight(activity_group == \"Surfing\") +\n  theme(\n    plot.title = element_markdown(family = \"josefin\",\n                                  face = \"bold\",\n                                  size = 17,\n                                  hjust = 1.5,\n                                  margin = margin(b = 40)),\n    panel.grid.major = element_line(color = \"gray\", size = 0.3),\n    panel.grid.major.x = element_blank(),  \n    #panel.grid.major.y = element_blank(),  \n    panel.grid.minor = element_blank(),\n    plot.margin = margin(40, 40, 20, 40),\n    axis.title.y = element_text(margin = margin(r = 20), hjust = 0.5, vjust = 1),\n    axis.title.x = element_text(margin = margin(r = 20), hjust = 0.5, vjust = 1)\n)\n\np + geom_vline(xintercept = 1959, linetype = \"dashed\", color = \"red\") +\n    annotate(\"text\", x = 1959, y = 40, \n             label = \"Gidget Premiers in Theaters\", vjust = -0.4, hjust = 1.1, color = \"red\", angle = 90)\n```\n:::\n\n\n![](line_plot.png)\nYou can see from this plot, that the number of annual attacks drastically increased starting in the 1960's. As I mentioned above, this is likely due to the growing popularity of the sport. More people in the water surfing carries a higher likelihood of an incident. I also noted when the film Gidget came out in 1959. This movie introduced Hollywood's first surfing movie star and pulled surfing into the mainstream culture. \n\n# Infographic\n\nIn order to combine these plots in a fun, educational and engaging way, I created an infographic to display the plots. This infographic explains the overarching question of \"Which ocean activities are most likely to encounter an aggressive shark incident?\". \n\n![](shark_poster.png)\n\n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}