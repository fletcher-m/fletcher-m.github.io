{
  "hash": "dd41c471f21dc1f1afcf2cef0355b38c",
  "result": {
    "markdown": "---\ntitle: \"Determining Suitable Habitat for Oysters within EEZ regions of California\"\ndescription: \"In this post, I analyze suitable habitat for oysters, based on temperature and depth parameters. I then find the amount of area within California EEZ regions that meets these requirements\"\nauthor:\n  - name: Fletcher McConnell\n    url: https://fletcher-m.github.io/\n   # orcid:\n    affiliation: MEDS\n    affiliation-url: https://bren.ucsb.edu/masters-programs/master-environmental-data-science/academics-meds\n # - name: other person\ndate: 12-01-2023\ncategories: [Quarto, MEDS, Ocean, Visualization]\nbibliography: references.bib\ncitation:\n  url: https://fletcher-m.github.io/blog/2023-12-01-eds223-final-project/\nimage: oysters.jpeg\n#image: ocean_data_image.jpeg\n# draft: true --> This setting will not show your blog post on your website but you can still see from url\neval: FALSE\n---\n\n\n## Finding Suitable Habitat for Oysters in California EEZ Boundaries\n\nAuthor: Fletcher McConnell\n\nGithub Reopository: https://github.com/fletcher-m/oyster-habitat\n\nThe idea of this analysis was to map areas that are suitable to oysters (based on depth and temperature parameters) and then find out which of the west coast economic exclusive zones (EEZ's) has the greatest potential for oyster fishing, based on total suitable area within each zone.\n\nBelow are the packages that I used in my analysis:\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# load packages\nlibrary(sf)\nlibrary(terra)\nlibrary(here)\nlibrary(dplyr)\nlibrary(tmap)\nlibrary(tidyverse)\nlibrary(stringr)\nlibrary(ggplot2)\nlibrary(raster)\n```\n:::\n\n\n## Finding Suitable Habitat for Oysters Along the California Coast\n\n### Data Wrangling\n\nFirst, I was interested in what portions of Califonia's coastline would be suitable for Oysters. They have an ideal depth range of 0 to 70 meters and ideal temperature range of 11 to 30 degrees Celsius. In order to find where these parameters are met, I used data of annual sea surface temperatures from 2008 to 2012 and then also used bathymetry data of the ocean. These first series of steps involve me doing a bit of data wrangling and making sure that I would be able to stack my depth raster with my temperature raster. I had previously combined all 4 years of temperature data into a raster stack 'all_sst'.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# find mean SST\nall_sst_mean <- mean(all_sst)\n\n# convert SST data to Celsius\nall_sst_mean <- all_sst_mean - 273.15\n\n# crop depth to match SST raster\ndepth <- crop(depth, all_sst_mean)\n\n# resample depth data to match SST resolution\ndepth <- resample(x = depth, y =  all_sst_mean, method = \"near\")\n\n# check that that depth and SST match in resolution, extent and crs (by stacking them)\ndepth_sst <- c(depth, all_sst_mean)\n```\n:::\n\n\n### Setting Raster Values to Align with Temperature and Depth Parameters\n\nAfter I had my depth and temperature rasters combined, I then needed to filter these rasters to the values that I wanted. As I mentioned above, Oysters like temperature between 11 and 33 degrees Celsius and do best in depths from 0 to 70 meters. After assigning these parameter values, I plotted areas along the coast that meet both of these criteria. The following is what I came up with:\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# set range for habitable oyster depth\ndepth_matrix <- matrix(c(-70, 0, 1,\n                    -Inf, -70, NA, 0, Inf, NA),\n                    byrow = TRUE, ncol = 3)\n\ndepth_sst <- classify(depth, depth_matrix)\n\n# set habitable range for oyster temperature\ntemp_matrix <- matrix(c(11, 30, 1,\n                        -Inf, 11, NA, 30, Inf, NA),\n                      byrow = TRUE, ncol = 3)\n\ntemp_sst <- classify(all_sst_mean, temp_matrix)\n\nocean <- stack(x = c(depth_sst, temp_sst))\n\n# find habitat that satisfies both temp range and depth range\nfunction_1 <- function(x, y){\n  ifelse(x ==1 & y == 1, 1, NA)\n}\nsuitable_habitat <- lapp(rast(ocean), fun = function_1)\n```\n:::\n\n\n![](temp_depth.png)\n\nThe above plot shows the California coastline. In this plot, I have set values within temperature and depth parameters equal to \"1\" and combined both rasters. The colored regions represent areas that are within both of the specified depth and temperature regions.\n\n### Overlaying Suitable Area with EEZ Regions\n\nNow that I had the area designated for suitable habitat for oysters, I wanted to explore which of the 5 EEZ regions along the west coast contained the most potential for oyster fishing. In order to do this, I needed to find the total suitable area within each EEZ region. Below is a plot showing each of the 5 regions and their corresponding total areas. The regions from North to South are Washington, Oregon, Northern California, Central California and Southern California.\n\n![](eez_regions.png)\n\nAs you can see, by comparing the plot above with plot showing suitable habitat, all of the EEZ regions contain at least some suitable oyster habitat. Now, I wanted to find out just how much suitable area there was in each region. This way, I would be able to rank each region in terms of potential for oyster farming. This next code section accomplishes exactly that.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# convert eez data into raster format\nwc_eez_raster <- rasterize(wc_eez, depth, field = \"rgn\")\n\n# find area of suitable habitat within each eez\narea <- expanse(suitable_habitat, unit = \"km\", zones = wc_eez_raster)\n\n# join calculate percent of suitable habitat and join back with eez data\ntotal_suitable_area <- merge(wc_eez, area,\n      by.x = \"rgn\",\n      by.y = \"zone\",\n      all.x = TRUE) |> \n  mutate(p_area = (area/area_km2) * 100)\n\ntotal_suitable_area\n```\n:::\n\n\n![](images/area_output.png)\n\nThe above is an output after I joined the amount of suitable area (\"area\") and percent of total area (\"p_area\") to the original EEZ data frame. This is the output that I was looking for. The step left was to visualize the results in order to gain a clearer picture. This first plot represents the total suitable area of each region.\n\n![](images/eez_area.png)\n\nAs you can see, Central California had the most suitable area and Northern California had the least. Now, I will compare this with the percentage of suitable area within each region.\n\n![](images/eez_percent-01.png)\n\nThis plot gives a bit of a different perspective, because it takes into account the size of each region. Washington ranks first with with the percent of area because it has a comparably smaller total area than the rest of the regions. Oregon and Northern California are the only two regions whose ranking remains unchanged in this second plot, ranking second lowest and lowest, respectively.\n\n## Generalizing the Process for Other Species\n\nAfter completing the analysis for oysters, I wanted to create a more general process to map areas for other species. In order to accomplish this, I wrote a function that follows the same basic process that I used above, using the same temperature and depth data. This function accepts the species, minimum depth, maximum depth, minimum temperature and maximum temperature as inputs and generates an area plot as well as a percentage of total EEZ area plot. Below, you can see the function that I created and an example of using the function for Skip jack Tuna.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# create general function for other species\nspecies_range_function <- function(species, min_depth, max_depth, min_temp, max_temp) {\n  \n  depth_input <- matrix(c(max_depth, min_depth, 1,\n                    -Inf, max_depth, NA, min_depth, Inf, NA),\n                    byrow = TRUE, ncol = 3)\n  \n  depth_classify <- classify(depth, depth_input)\n  \n  temp_input <- matrix(c(min_temp, max_temp, 1,\n                        -Inf, min_temp, NA, max_temp, Inf, NA),\n                      byrow = TRUE, ncol = 3)\n  \n  temp_classify <- classify(all_sst_mean, temp_input)\n  \n  depth_temp_stack <- stack(x = c(depth_classify, temp_classify))\n  \n  ocean_function <- function(x, y){\n  ifelse(x == 1 & y == 1, 1, NA)\n}\n  oyster_habitat <- lapp(rast(depth_temp_stack), fun = ocean_function)\n  \n  eez_raster <- rasterize(wc_eez, depth, field = \"rgn\") # not sure about this one\n  \n  oyster_area <- expanse(oyster_habitat, unit = \"km\", zones = eez_raster)\n  \n  joined_data <<- merge(wc_eez, oyster_area,\n      by.x = \"rgn\",\n      by.y = \"zone\",\n      all.x = TRUE) |> \n  mutate(p_area = (area/area_km2) * 100)\n  \n  fish_area_plot <- ggplot(joined_data) +\n    geom_sf(aes(fill = area)) +\n    scale_fill_viridis_c() + \n    labs(title = paste(\"Area of Suitable\", species, \"Habitat in EEZ Regions\"), fill = \"Area (km^2)\")\n  \n  print(fish_area_plot)\n  \n  fish_percent_plot <- ggplot(joined_data) +\n    geom_sf(aes(fill = p_area)) +\n    scale_fill_viridis_c() + \n    labs(title = paste(\"Percent of Suitable\", species, \"Habitat of EEZ Regions\"), fill = \"Percent of Total Area\")\n  \n  print(fish_percent_plot)\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# apply created function to Skipjack Tuna\nspecies_range_function(\"Skipjack Tuna\", 0, -260, 10, 21)\n```\n:::\n\n\n![](images/skpjack_area.png)\n\n![](images/skpjack_percent.png)\n\nAs you can see, the function created new plots that are based on the new temperature and depth parameters that are related to the Skipjack Tuna. This will be able to accept any values that are input, as long as they are included in the original temperature and depth data used.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}